name: Release bitcoind image

on:
  push:
    branches: ["feat/byob-slsa-wrapper"]

permissions:
  id-token: write
  contents: read
  actions: read
  packages: write

jobs:
  build:
    uses: your-org/your-tool-repo/.github/workflows/builder_slsa3.yml@v1
    permissions:
      id-token: write
      contents: read
      actions: read
      packages: write
    with:
      version: "v27.0"
      registry: ghcr.io
      image_name: ${{ github.repository }}/bitcoind
      push: true
      rekor-log-public: true
    secrets:
      registry-password: ${{ secrets.GITHUB_TOKEN }}

  summary:
    needs: build
    runs-on: ubuntu-latest
    steps:
      - run: |
          echo "Image:  ${{ needs.build.outputs.image }}"
          echo "Digest: ${{ needs.build.outputs.digest }}"
