name: SLSA Docker Builder
on: [push, workflow_dispatch]

permissions:
  id-token: write
  contents: write
  actions: read
  packages: write # For GHCR push

jobs:
  build:
    uses: slsa-framework/slsa-github-generator/.github/workflows/builder_container-based_slsa3.yml@v2.1.0
    with:
      builder-image: "moby/buildkit"
      builder-digest: "sha256:5601811fde88bb9e8a577bfe804af82bccb712e1cd07ff94663bded5e628cf75"
      config-path: "images/bitcoind/config.toml" # ‚Üê Path from repo root
      registry-username: ${{ github.actor }}
    secrets:
      registry-password: ${{ secrets.GITHUB_TOKEN }}
