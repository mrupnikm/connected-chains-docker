name: SLSA Docker Builder
on: [push, workflow_dispatch]

permissions:
  id-token: write
  contents: write
  actions: read
  packages: write # For GHCR push

jobs:
  build:
    uses: slsa-framework/slsa-github-generator/.github/workflows/builder_container-based_slsa3.yml@v2.1.0
    with:
      builder-image: "moby/buildkit"
      builder-digest: "sha256:d2d84019c976ee62863bb5eb0c98c796a324cfbecb220d692119184382def15e"
      config-path: "images/bitcoind/config.toml" # ‚Üê Path from repo root
      registry-username: ${{ github.actor }}
    secrets:
      registry-password: ${{ secrets.GITHUB_TOKEN }}
