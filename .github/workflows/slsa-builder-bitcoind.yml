name: SLSA Docker Builder
on: [push, workflow_dispatch]

permissions:
  id-token: write
  contents: write
  actions: read
  packages: write # For GHCR push

jobs:
  build:
    uses: slsa-framework/slsa-github-generator/.github/workflows/builder_container-based_slsa3.yml@v2.1.0
    with:
      builder-image: "docker/buildx-bin"
      builder-digest: "sha256:fcf5d30e5211e6ba0cd3dd94f26ae9824272c264069772e65bea26f0ec469717"
      config-path: "images/bitcoind/config.toml" # ‚Üê Path from repo root
      registry-username: ${{ github.actor }}
    secrets:
      registry-password: ${{ secrets.GITHUB_TOKEN }}
